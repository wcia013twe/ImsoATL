{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/wes/Desktop/Project/ImsoATL/app/frontend/components/ChatSidebar.tsx"],"sourcesContent":["'use client';\n\nimport { useState, useRef, useEffect } from 'react';\nimport type { ChatMessage, AgentStep, WebSocketMessage, DeploymentPlan } from '@/lib/types';\n\nconst WEBSOCKET_URL = 'ws://localhost:8000/ws/chat';\nconst STORAGE_KEY = 'atlas-chat-messages';\n\nconst getInitialMessages = (): ChatMessage[] => {\n  if (typeof window === 'undefined') return getDefaultMessages();\n\n  try {\n    const stored = localStorage.getItem(STORAGE_KEY);\n    if (stored) {\n      const parsed = JSON.parse(stored);\n      // Convert timestamp strings back to Date objects\n      const messagesWithDates = parsed.map((msg: any) => ({\n        ...msg,\n        timestamp: new Date(msg.timestamp)\n      }));\n      return messagesWithDates.length > 0 ? messagesWithDates : getDefaultMessages();\n    }\n  } catch (error) {\n    console.error('Error loading chat messages:', error);\n  }\n\n  return getDefaultMessages();\n};\n\nconst getDefaultMessages = (): ChatMessage[] => [\n  {\n    id: '1',\n    role: 'assistant',\n    content: \"Hi! I'm your WiFi planning assistant powered by multi-agent AI. I analyze Census demographics, FCC broadband data, and civic assets to recommend optimal deployment sites. Ask me anything!\",\n    timestamp: new Date()\n  }\n];\n\nexport default function ChatSidebar({\n  isOpen,\n  onClose,\n  cityName,\n  onRecommendationsReceived\n}: {\n  isOpen: boolean;\n  onClose: () => void;\n  cityName?: string;\n  onRecommendationsReceived?: (plan: DeploymentPlan) => void;\n}) {\n  const [messages, setMessages] = useState<ChatMessage[]>(getInitialMessages);\n  const [inputValue, setInputValue] = useState('');\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [showSuggestions, setShowSuggestions] = useState(true);\n  const [typingStep, setTypingStep] = useState<AgentStep | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n  const wsRef = useRef<WebSocket | null>(null);\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  const suggestions = [\n    \"Where should we deploy WiFi for underserved students?\",\n    \"Which areas have the worst broadband coverage gaps?\",\n    \"Show me high-poverty neighborhoods without internet access\",\n    \"Find the best sites near libraries and community centers\"\n  ];\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages, typingStep]);\n\n  useEffect(() => {\n    if (isOpen && inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [isOpen]);\n\n  // Persist messages to localStorage whenever they change\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      try {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(messages));\n      } catch (error) {\n        console.error('Error saving chat messages:', error);\n      }\n    }\n  }, [messages]);\n\n  const connectWebSocket = (userMessage: string) => {\n    const ws = new WebSocket(WEBSOCKET_URL);\n    wsRef.current = ws;\n    const processingMessageId = `processing-${Date.now()}`;\n\n    ws.onopen = () => {\n      console.log('WebSocket connected');\n\n      // Create ONE processing message that will accumulate all steps\n      const thinkingMessage: ChatMessage = {\n        id: processingMessageId,\n        role: 'assistant',\n        content: 'ðŸ¤” Analyzing your request...',\n        timestamp: new Date(),\n        type: 'processing',\n        agentSteps: []  // Initialize empty array for accumulation\n      };\n      setMessages(prev => [...prev, thinkingMessage]);\n\n      // Send user message to backend\n      ws.send(JSON.stringify({\n        message: userMessage,\n        city: cityName || 'Atlanta'\n      }));\n    };\n\n    ws.onmessage = (event) => {\n      const data: WebSocketMessage = JSON.parse(event.data);\n\n      if (data.type === 'agent_step') {\n        const agentStep: AgentStep = {\n          agent: data.agent || '',\n          action: data.action || '',\n          status: data.status || 'in_progress',\n          data: data.data\n        };\n\n        // UPDATE the existing processing message by accumulating steps\n        setMessages(prev => prev.map(msg => {\n          if (msg.id === processingMessageId) {\n            const existingSteps = msg.agentSteps || [];\n            return {\n              ...msg,\n              agentSteps: [...existingSteps, agentStep],\n              content: `processing-${Date.now()}`,  // Change content to force re-render\n              timestamp: new Date()  // Update timestamp to force re-render\n            };\n          }\n          return msg;\n        }));\n\n        // Show typing indicator for current agent\n        setTypingStep({\n          agent: agentStep.agent,\n          action: agentStep.action,\n          status: agentStep.status\n        });\n      } else if (data.type === 'final_response') {\n        // Clear typing indicator\n        setTypingStep(null);\n\n        // Replace processing message with final response\n        setMessages(prev => prev.map(msg =>\n          msg.id === processingMessageId\n            ? {\n                ...msg,\n                content: data.explanation || 'Analysis complete.',\n                type: 'final_response',\n                deploymentPlan: data.deployment_plan\n              }\n            : msg\n        ));\n\n        setIsProcessing(false);\n\n        // Notify parent component of recommendations\n        if (data.deployment_plan && onRecommendationsReceived) {\n          onRecommendationsReceived(data.deployment_plan);\n        }\n\n        ws.close();\n      } else if (data.type === 'error') {\n        // Clear typing indicator\n        setTypingStep(null);\n\n        // Replace processing message with error\n        setMessages(prev => prev.map(msg =>\n          msg.id === processingMessageId\n            ? {\n                ...msg,\n                content: `âš ï¸ Error: ${data.message || 'An error occurred'}`,\n                type: 'error'\n              }\n            : msg\n        ));\n\n        setIsProcessing(false);\n        ws.close();\n      }\n    };\n\n    ws.onerror = (error) => {\n      console.error('WebSocket error:', error);\n      setTypingStep(null);\n\n      const errorMessage: ChatMessage = {\n        id: Date.now().toString(),\n        role: 'assistant',\n        content: 'âš ï¸ Connection error. Please make sure the backend server is running on port 8000.',\n        timestamp: new Date(),\n        type: 'error'\n      };\n      setMessages(prev => [...prev, errorMessage]);\n      setIsProcessing(false);\n    };\n\n    ws.onclose = () => {\n      console.log('WebSocket disconnected');\n      wsRef.current = null;\n    };\n  };\n\n  const handleSendMessage = async (text?: string) => {\n    const messageText = text || inputValue.trim();\n    if (!messageText || isProcessing) return;\n\n    // Add user message\n    const userMessage: ChatMessage = {\n      id: Date.now().toString(),\n      role: 'user',\n      content: messageText,\n      timestamp: new Date()\n    };\n\n    setMessages(prev => [...prev, userMessage]);\n    setInputValue('');\n    setShowSuggestions(false);\n    setIsProcessing(true);\n\n    // Connect to WebSocket and send message\n    connectWebSocket(messageText);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  const handleClearConversation = () => {\n    if (confirm('Are you sure you want to clear the conversation history?')) {\n      const defaultMessages = getDefaultMessages();\n      setMessages(defaultMessages);\n      setShowSuggestions(true);\n      if (typeof window !== 'undefined') {\n        localStorage.removeItem(STORAGE_KEY);\n      }\n    }\n  };\n\n  const getAgentIcon = (agentName: string): string => {\n    if (agentName.includes('Query Parser')) return 'ðŸ”';\n    if (agentName.includes('Census')) return 'ðŸ“Š';\n    if (agentName.includes('FCC')) return 'ðŸ“¡';\n    if (agentName.includes('Assets')) return 'ðŸ›ï¸';\n    if (agentName.includes('Synthesis')) return 'ðŸ§ ';\n    if (agentName.includes('Ranking')) return 'âš–ï¸';\n    if (agentName.includes('Explainer')) return 'âœ¨';\n    return 'ðŸ¤–';\n  };\n\n  const isOrchestratorThinking = (step: AgentStep): boolean => {\n    return step.agent.includes('Orchestrator') && step.status === 'completed';\n  };\n\n  const isProcessRunning = (step: AgentStep): boolean => {\n    return step.status === 'in_progress' && !step.agent.includes('Orchestrator');\n  };\n\n  return (\n    <>\n      {/* Sidebar */}\n      <div\n        className={`fixed top-0 left-0 h-full w-[32rem] bg-surface border-r border-border z-50 transform transition-transform duration-300 ease-in-out ${\n          isOpen ? 'translate-x-0' : '-translate-x-full'\n        }`}\n      >\n        <div className=\"flex flex-col h-full\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between px-6 py-4 border-b border-border\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-2 h-2 rounded-full bg-civic-green animate-pulse\" />\n              <h2 className=\"text-lg font-semibold text-foreground\">Multi-Agent AI Assistant</h2>\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={handleClearConversation}\n                className=\"p-1 rounded-lg hover:bg-surface-hover transition-colors text-muted hover:text-foreground\"\n                title=\"Clear conversation\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\" />\n                </svg>\n              </button>\n              <button\n                onClick={onClose}\n                className=\"p-1 rounded-lg hover:bg-surface-hover transition-colors text-muted hover:text-foreground\"\n                title=\"Close chat\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n\n          {/* Messages */}\n          <div className=\"flex-1 overflow-y-auto px-6 py-4 space-y-4\">\n            {messages.map((message) => (\n              <div\n                key={message.id}\n                className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}\n              >\n                <div\n                  className={`max-w-[90%] rounded-2xl px-4 py-3 ${\n                    message.role === 'user'\n                      ? 'bg-civic-blue text-white'\n                      : message.type === 'agent_step'\n                      ? 'bg-surface-hover border border-border'\n                      : 'bg-surface-hover text-foreground border border-border'\n                  }`}\n                >\n                  {/* Processing Message - Shows all accumulated agent steps */}\n                  {message.type === 'processing' && message.agentSteps && (\n                    <div className=\"text-xs space-y-2\">\n                      <div className=\"font-semibold text-muted mb-2\">ðŸ¤” Analyzing your request...</div>\n                      {message.agentSteps.map((step, idx) => (\n                        <div key={idx} className=\"flex items-start gap-2 pl-2 border-l-2 border-civic-blue/30\">\n                          <span className=\"flex-shrink-0 mt-0.5\">{getAgentIcon(step.agent)}</span>\n                          <div className=\"flex-1\">\n                            <div className=\"font-semibold text-foreground flex items-center gap-2\">\n                              {step.agent}\n                              {step.status === 'in_progress' && (\n                                <svg className=\"w-3 h-3 animate-spin text-civic-blue\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                                  <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                                  <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 714 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                                </svg>\n                              )}\n                              {step.status === 'completed' && (\n                                <span className=\"text-civic-green\">âœ“</span>\n                              )}\n                            </div>\n                            <div className=\"text-accent mt-0.5\">{step.action}</div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  )}\n\n                  {/* Agent Step Message */}\n                  {message.type === 'agent_step' && message.agentSteps?.[0] && (\n                    <div className=\"text-xs flex items-start gap-2\">\n                      <span className=\"flex-shrink-0 mt-0.5\">{getAgentIcon(message.agentSteps[0].agent)}</span>\n                      <div className=\"flex-1\">\n                        <div className=\"font-semibold text-foreground flex items-center gap-2\">\n                          {message.agentSteps[0].agent}\n                          {isProcessRunning(message.agentSteps[0]) && (\n                            <svg className=\"w-3 h-3 animate-spin text-civic-blue\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                            </svg>\n                          )}\n                          {message.agentSteps[0].status === 'completed' && !isOrchestratorThinking(message.agentSteps[0]) && (\n                            <span className=\"text-civic-green\">âœ“</span>\n                          )}\n                        </div>\n                        <div className=\"text-accent mt-1\">\n                          {message.content}\n                          {isOrchestratorThinking(message.agentSteps[0]) && (\n                            <span className=\"inline-flex ml-1\">\n                              <span className=\"animate-[bounce_1s_infinite_0ms]\">.</span>\n                              <span className=\"animate-[bounce_1s_infinite_200ms]\">.</span>\n                              <span className=\"animate-[bounce_1s_infinite_400ms]\">.</span>\n                            </span>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  )}\n\n                  {/* Regular Message */}\n                  {message.type !== \"agent_step\" && message.type !== \"processing\" && (\n                    <>\n                      <p className=\"text-sm leading-relaxed whitespace-pre-wrap\">{message.content}</p>\n\n                      <span className={`text-xs mt-2 block ${\n                        message.role === 'user' ? 'text-white/70' : 'text-muted'\n                      }`}>\n                        {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}\n                      </span>\n                    </>\n                  )}\n                </div>\n              </div>\n            ))}\n\n            {/* Typing Indicator */}\n            {isProcessing && typingStep && (\n              <div className=\"flex justify-start\">\n                <div className=\"max-w-[90%] bg-surface-hover border border-border rounded-2xl px-4 py-3\">\n                  <div className=\"text-xs flex items-start gap-2\">\n                    <span className=\"flex-shrink-0 mt-0.5\">{getAgentIcon(typingStep.agent)}</span>\n                    <div className=\"flex-1\">\n                      <div className=\"font-semibold text-foreground\">{typingStep.agent}</div>\n                      <div className=\"text-accent mt-1\">\n                        <span className=\"inline-flex gap-0.5\">\n                          <span className=\"animate-[bounce_1s_infinite_0ms]\">.</span>\n                          <span className=\"animate-[bounce_1s_infinite_200ms]\">.</span>\n                          <span className=\"animate-[bounce_1s_infinite_400ms]\">.</span>\n                        </span>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            )}\n\n            <div ref={messagesEndRef} />\n          </div>\n\n          {/* Suggestions */}\n          {showSuggestions && messages.length === 1 && (\n            <div className=\"px-6 pb-4\">\n              <div className=\"text-xs font-semibold text-muted uppercase tracking-wider mb-3\">\n                Suggested Questions\n              </div>\n              <div className=\"space-y-2\">\n                {suggestions.map((suggestion, index) => (\n                  <button\n                    key={index}\n                    onClick={() => handleSendMessage(suggestion)}\n                    className=\"w-full text-left px-3 py-2 rounded-lg border border-border text-sm text-accent hover:bg-surface-hover hover:text-foreground transition-colors\"\n                  >\n                    {suggestion}\n                  </button>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {/* Input */}\n          <div className=\"px-6 py-4 border-t border-border\">\n            <div className=\"flex gap-2\">\n              <input\n                ref={inputRef}\n                type=\"text\"\n                value={inputValue}\n                onChange={(e) => setInputValue(e.target.value)}\n                onKeyPress={handleKeyPress}\n                placeholder=\"Ask me about WiFi deployment...\"\n                disabled={isProcessing}\n                className=\"flex-1 px-4 py-3 rounded-xl bg-background border border-border text-foreground placeholder-muted focus:outline-none focus:ring-2 focus:ring-civic-blue focus:border-transparent disabled:opacity-50\"\n              />\n              <button\n                onClick={() => handleSendMessage()}\n                disabled={!inputValue.trim() || isProcessing}\n                className=\"px-4 py-3 rounded-xl bg-civic-blue text-white font-semibold hover:bg-civic-blue-600 transition-colors disabled:opacity-40 disabled:cursor-not-allowed\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 19l9 2-9-18-9 18 9-2zm0 0v-8\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 812, "column": 0}, "map": {"version":3,"sources":["file:///Users/wes/Desktop/Project/ImsoATL/app/frontend/app/dashboard/%5Bcity%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState, useRef } from 'react';\nimport DashboardHeader from '@/components/DashboardHeader';\nimport ChatSidebar from '@/components/ChatSidebar';\nimport PrioritySliders from '@/components/PrioritySliders';\nimport InteractiveMap from '@/components/InteractiveMap';\nimport RecommendationsSidebar from '@/components/RecommendationsSidebar';\nimport Footer from '@/components/Footer';\nimport type { DeploymentPlan } from '@/lib/types';\n\ntype CityData = {\n  id: number;\n  name: string;\n  state: string;\n  slug: string;\n  coords: [number, number];\n};\n\nexport default function DashboardPage({ params }: { params: { city: string } }) {\n  const [cityData, setCityData] = useState<CityData | null>(null);\n  const [isChatOpen, setIsChatOpen] = useState(true);\n  const [isRecommendationsOpen, setIsRecommendationsOpen] = useState(false);\n  const [recommendations, setRecommendations] = useState<DeploymentPlan | null>(null);\n  const mapRef = useRef<{ showRecommendations: (plan: DeploymentPlan) => void } | null>(null);\n\n  useEffect(() => {\n    // Retrieve city data from localStorage\n    const storedCity = localStorage.getItem('selectedCity');\n    if (storedCity) {\n      const city = JSON.parse(storedCity) as CityData;\n      setCityData(city);\n    }\n  }, []);\n\n  const handleRecommendationsReceived = (plan: DeploymentPlan) => {\n    setRecommendations(plan);\n    setIsRecommendationsOpen(true); // Auto-open recommendations sidebar\n    // Notify map component to show recommendations\n    if (mapRef.current && mapRef.current.showRecommendations) {\n      mapRef.current.showRecommendations(plan);\n    }\n  };\n\n  if (!cityData) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center\">\n        <p className=\"text-foreground\">Loading dashboard...</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background flex\">\n      {/* Chat Sidebar (Left) */}\n      <ChatSidebar\n        isOpen={isChatOpen}\n        onClose={() => setIsChatOpen(false)}\n        cityName={cityData.name}\n        onRecommendationsReceived={handleRecommendationsReceived}\n      />\n\n      {/* Recommendations Sidebar (Right) */}\n      <RecommendationsSidebar\n        isOpen={isRecommendationsOpen}\n        onClose={() => setIsRecommendationsOpen(false)}\n        deploymentPlan={recommendations}\n      />\n\n      {/* Main Dashboard - shifts when sidebars are open */}\n      <div\n        className={`flex-1 transition-all duration-300 ${\n          isChatOpen ? 'ml-[32rem]' : 'ml-0'\n        } ${\n          isRecommendationsOpen ? 'mr-96' : 'mr-0'\n        }`}\n      >\n        <DashboardHeader\n          onToggleChat={() => setIsChatOpen(!isChatOpen)}\n          cityName={cityData.name}\n        />\n\n        <div className=\"relative\">\n          {/* <PrioritySliders /> */}\n          <InteractiveMap\n            cityCenter={cityData.coords}\n            cityName={cityData.name}\n            recommendations={recommendations}\n          />\n          {/* <Footer /> */}\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;;;AAEA;;;;;;;;;;;AAJA;;;;;;;AAmBe,SAAS,cAAc,EAAE,MAAM,EAAgC;IAC5E,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAkB;IAC1D,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAC7C,MAAM,CAAC,uBAAuB,yBAAyB,GAAG,IAAA,iNAAQ,EAAC;IACnE,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,iNAAQ,EAAwB;IAC9E,MAAM,SAAS,IAAA,+MAAM,EAAiE;IAEtF,IAAA,kNAAS,EAAC;QACR,uCAAuC;QACvC,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACd,MAAM,OAAO,KAAK,KAAK,CAAC;YACxB,YAAY;QACd;IACF,GAAG,EAAE;IAEL,MAAM,gCAAgC,CAAC;QACrC,mBAAmB;QACnB,yBAAyB,OAAO,oCAAoC;QACpE,+CAA+C;QAC/C,IAAI,OAAO,OAAO,IAAI,OAAO,OAAO,CAAC,mBAAmB,EAAE;YACxD,OAAO,OAAO,CAAC,mBAAmB,CAAC;QACrC;IACF;IAEA,IAAI,CAAC,UAAU;QACb,qBACE,8OAAC;YAAI,WAAU;sBACb,cAAA,8OAAC;gBAAE,WAAU;0BAAkB;;;;;;;;;;;IAGrC;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC,qIAAW;gBACV,QAAQ;gBACR,SAAS,IAAM,cAAc;gBAC7B,UAAU,SAAS,IAAI;gBACvB,2BAA2B;;;;;;0BAI7B,8OAAC;gBACC,QAAQ;gBACR,SAAS,IAAM,yBAAyB;gBACxC,gBAAgB;;;;;;0BAIlB,8OAAC;gBACC,WAAW,CAAC,mCAAmC,EAC7C,aAAa,eAAe,OAC7B,CAAC,EACA,wBAAwB,UAAU,QAClC;;kCAEF,8OAAC;wBACC,cAAc,IAAM,cAAc,CAAC;wBACnC,UAAU,SAAS,IAAI;;;;;;kCAGzB,8OAAC;wBAAI,WAAU;kCAEb,cAAA,8OAAC;4BACC,YAAY,SAAS,MAAM;4BAC3B,UAAU,SAAS,IAAI;4BACvB,iBAAiB;;;;;;;;;;;;;;;;;;;;;;;AAO7B"}},
    {"offset": {"line": 946, "column": 0}, "map": {"version":3,"sources":["file:///Users/wes/Desktop/Project/ImsoATL/app/frontend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 965, "column": 0}, "map": {"version":3,"sources":["file:///Users/wes/Desktop/Project/ImsoATL/app/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 970, "column": 0}, "map": {"version":3,"sources":["file:///Users/wes/Desktop/Project/ImsoATL/app/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}